binance:
  api_key: "${BINANCE_API_KEY}"
  api_secret: "${BINANCE_API_SECRET}"
  proxy:
    http:  "http://127.0.0.1:7890"
    https: "http://127.0.0.1:7890"

coingecko:
  api_key: "${COINGECKO_API_KEY}"  # 可为空或填写公共 API 密钥

mysql:
  host: "localhost"
  port: 3306
  user: "root"
  password: "${MYSQL_PASSWORD}"
  database: "quant_trading"
  charset: "utf8mb4"

data_loader:
  topn: 100             # 获取成交额排名前N的合约
  interval: "1h"       # 主周期K线
  aux_interval: ["5m", "15m", "4h", "1d"]   # 辅助周期K线
  start:  # 起始日期 例如"2024-06-01" 默认获取一年
  end:     # 结束日期
  cache_dir: "data/klines"
  sentiment_cache: "data/sentiment"
  rate_limit_sleep: 0.05   # 每次请求后休息 50ms，1s 20 次 ≪ 2400/min
  excluded_list: ["BUSDT"]

feature_engineering:
  cache_dir: "data/klines"
  merged_dir: "data/merged"
  merged_table_path: "data/merged/merged_table.csv"
  feature_cols_path: "data/merged/feature_cols.txt"
  topn: 100
  mode: train                        # train 或 inference
  scaler_path: scalers/all_features_scaler.json
  btc_symbol: "BTCUSDT"
  eth_symbol: "ETHUSDT"

feature_selector:
  target: target_up   # 也可换 target_up
  top_n: 100             # 每周期保留前 N

models:
  1h:
    up: models/model_1h_up.pkl
    down: models/model_1h_down.pkl
    vol: models/model_1h_vol.pkl
  4h:
    up: models/model_4h_up.pkl
    down: models/model_4h_down.pkl
    vol: models/model_4h_vol.pkl
  d1:
    up: models/model_1d_up.pkl
    down: models/model_1d_down.pkl
    vol: models/model_1d_vol.pkl

database:
  uri: "mysql+pymysql://user:pwd@host:3306/quant_trading"

feature_cols:
  1h:           # 样本量 ≈ 552k，Feat/样本 ≈ 1∶2750
    - pct_chg1_1h           # 1.000
    - bear_streak_1h        # 0.995
    - pct_chg3_1h           # 0.990
    - cci_delta_1h          # 0.985
    - close_spread_1h_4h    # 0.975
    - cci_1h                # 0.965
    - atr_pct_ratio_1h_4h   # 0.955
    - bull_streak_1h        # 0.945
    - vol_ma_ratio_long_1h  # 0.940
    - obv_delta_1h          # 0.935
    - upper_wick_ratio_1h   # 0.930
    - lower_wick_ratio_1h   # 0.910
    - hour_of_day           # 0.925
    - day_of_week           # 0.900
    - vol_roc_1h            # 0.871
  4h:
    - vol_ratio_1h_4h       # 0.706  跨周期量比
    - atr_pct_ratio_1h_4h   # 0.915  跨周期波动率比
    - rsi_slope_4h          # 0.900  中线趋势斜率
    - vol_roc_4h            # 0.851  量能环比
    - lower_wick_ratio_4h   # 0.940  买盘吸收
    - atr_chg_4h            # 0.806  波动率动量
    - pct_chg6_4h           # 0.935  6 根动量
    - bb_width_ratio_1h_4h  # 0.786  跨周期布林带比
    - upper_wick_ratio_4h   # 0.930  卖盘抛压

    # ——— 新增 1h 高贡献因子 ———
    - pct_chg1_1h           # 1.000  极短线动量
    - bear_streak_1h        # 0.995  连跌动能
    - cci_delta_1h          # 0.985  短期趋势斜率
  1d:
    - fg_index_d1           # 0.960  恐惧-贪婪情绪
    - cg_market_cap_roc_d1  # 0.955  宏观市值变化
    - macd_signal_d1        # 0.930  长线趋势信号
    - macd_hist_diff_1h_d1  # 0.910  日线与 1h MACD 差异
    - kc_width_pct_chg_d1   # 0.866  Keltner 通道宽度变化
    - hv_14d_d1             # 0.856  14 天历史波动率
    - cg_total_volume_roc_d1 # 0.841  市值成交量变化
    - pct_chg6_4h           # 0.935  4h 中期动量
    - atr_pct_ratio_1h_4h   # 0.915  跨周期波动率比
    - bear_streak_1h        # 0.995  1h 连跌动能

train_settings:
  by_symbol: false
  min_rows: 500
  time_ranges: []
  ts_smote: true

# Δ-boost 配置：关键指标与参数
delta_boost:
  core_keys:
    "1h":
      - rsi_1h
      - macd_hist_1h
      - ema_diff_1h
      - atr_pct_1h
      - vol_ma_ratio_1h
      - funding_rate_1h
    "4h":
      - rsi_4h
      - macd_hist_4h
      - ema_diff_4h
    d1:
      - rsi_d1
      - macd_hist_d1
      - ema_diff_d1
  params:
    rsi: [5, 1.0, 0.05]
    macd_hist: [0.002, 100.0, 0.05]
    ema_diff: [0.001, 100.0, 0.03]
    atr_pct: [0.002, 100.0, 0.03]
    vol_ma_ratio: [0.2, 1.0, 0.03]
    funding_rate: [0.0005, 10000, 0.03]


vote_system:
  weight_ai: 2.0
  strong_min: 5
  conf_min: 0.40

# === 调参选项 ===
sentiment_alpha: 0.5
cap_positive_scale: 0.7
volume_guard:
  weak_scale: 0.85
  over_scale: 0.9
  ratio_low: 0.6
  ratio_high: 2.0
  roc_low: -20
  roc_high: 100
ob_threshold:
  min_ob_th: 0.15
  dynamic_factor: 0.08
risk_score_cap: 5.0
exit_lag_bars: 1
low_base: 0.10
quantile: 0.88
vote:
  strong_min: 3
  conf_min: 0.25
oi_protection:
  scale: 0.9
  crowding_threshold: 0.90
veto_level: 0.9
flip_coeff: 0.3
